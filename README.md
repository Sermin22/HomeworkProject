# Функции для виджета банковских операций клиента

## Описание основного модуля main:

Функция main в модуле main отвечает за основную логику проекта и связывает 
функциональности между собой.

Ожидаемое поведение программы следующее:

```
Программа приветствует пользователя:
Программа: Привет! Добро пожаловать в программу работы 
с банковскими транзакциями. 
Выберите необходимый пункт меню:
1. Получить информацию о транзакциях из JSON-файла
2. Получить информацию о транзакциях из CSV-файла
3. Получить информацию о транзакциях из XLSX-файла

Пользователь: 1

Программа: Для обработки выбран JSON-файл.

После пользователь выбирает статус интересующих его операций.

Программа: Введите статус, по которому необходимо выполнить фильтрацию. 
Доступные для фильтровки статусы: EXECUTED, CANCELED, PENDING

Пользователь: EXECUTED

Программа: Операции отфильтрованы по статусу "EXECUTED"

В случае, если пользователь ввел неверный статус, программа не должна падать 
в ошибку, а должна возвращать пользователя к вводу корректного статуса:

Пользователь: test

Программа: Статус операции "test" недоступен.

Программа: Введите статус, по которому необходимо выполнить фильтрацию. 
Доступные для фильтровки статусы: EXECUTED, CANCELED, PENDING

После фильтрации программа выводит следующие вопросы для уточнения выборки 
операций, необходимых пользователю, и выводит в консоль операции, соответствующие 
выборке пользователя:
Программа: Отсортировать операции по дате? Да/Нет

Пользователь: да

Программа: Отсортировать по возрастанию или по убыванию? 

Пользователь: по возрастанию/по убыванию

Программа: Выводить только рублевые тразакции? Да/Нет

Пользователь: да

Программа: Отфильтровать список транзакций по определенному слову 
в описании? Да/Нет

Пользователь: да/нет

Программа: Распечатываю итоговый список транзакций...

Программа: 
Всего банковских операций в выборке: 4

08.12.2019 Открытие вклада 
Счет **4321
Сумма: 40542 руб. 

12.11.2019 Перевод с карты на карту
MasterCard 7771 27** **** 3727 -> Visa Platinum 1293 38** **** 9203
Сумма: 130 USD

18.07.2018 Перевод организации 
Visa Platinum 7492 65** **** 7202 -> Счет **0034
Сумма: 8390 руб.

03.06.2018 Перевод со счета на счет
Счет **2935 -> Счет **4321
Сумма: 8200 EUR

Если выборка оказалась пустой, программа выводит сообщение:

Программа: Не найдено ни одной транзакции, подходящей под ваши
условия фильтрации
```

## Описание модуля processing.py:

**1. Функция filter_by_state:**

Принимает список словарей и опционально значение для ключа state 
(по умолчанию 'EXECUTED'). Функция возвращает новый список словарей, 
содержащий только те словари, у которых ключ state соответствует 
указанному значению.

**2. Функция sort_by_date:**

Принимает список словарей и необязательный параметр, задающий порядок 
сортировки (по умолчанию — убывание). Функция возвращает новый список,
отсортированный по дате (date).

## Тестирование модулей и функций processing.py:

Тесты выполнены в пакете tests в модулях test_name_module (название тестируемого модуля)
с использованием библиотеки pytest.

Тестирование отслеживает:

- Правильность маскирования номера карты и счета, преобразования даты;
- Проверка работы функции на различных входных форматах номеров карт, счетов, даты,
включая граничные случаи и нестандартные длины номеров;
- Проверка, что функция корректно обрабатывает входные строки, где отсутствует дата,
номер карты или номер счета меньше ожидаемой длины;
- Параметризованные тесты с разными типами карт и счетов для проверки универсальности 
функции;
- Тестирование функций на обработку некорректных входных данных и проверка ее 
устойчивости к ошибкам;
- Тестирование фильтрации списка словарей по заданному статусу state и по его отсутствию;
- Параметризация тестов для различных возможных значений статуса;
- Использовали фикстуры, выполненные в модуле conftest.py и параметризация, для
обеспечения тестирования функциональности с различными входными данными;
- Покрытие тестами более 94% кода.

## Описание модуля generators.py:

**1. Функция filter_by_currency:**

Принимает на вход список словарей, представляющих транзакции и возвращает 
итератор, который поочередно выдает транзакции, где валюта операции соответствует 
заданной (например, USD).

**2. Функция генератор transaction_descriptions:**

Принимает список словарей с транзакциями и возвращает описание каждой операции 
по очереди.

**3. Функция генератор card_number_generator:**

Выдает номера банковских карт в формате XXXX XXXX XXXX XXXX, где X — цифра номера карты. Генератор может сгенерировать номера карт в заданном диапазоне от 0000 0000 0000 0001 до 9999 9999 9999 9999.
Генератор принимает начальное и конечное значения для генерации диапазона номеров.

## Тестирование модулей и функций generators.py:

Тесты выполнены в пакете tests в модулях test_name_module (название тестируемого модуля)
с использованием библиотеки pytest.

Тестирование отслеживает:

- Правильность обрабатывания случаев, когда транзакции в заданной валюте отсутствуют.
Генератор не завершается ошибкой при обработке пустого списка или списка без соответствующих валютных операций.
- Функция возвращает корректные описания для каждой транзакции, включая работу функции с различным количеством входных транзакций, в том числе пустой список.
- Генератор выдает правильные номера карт в заданном диапазоне. Корректно форматирует номера карт.
- Генератор правильно обрабатывает крайние значения диапазона и правильно завершает генерацию.
- Покрытие тестами более 94% кода.

## Описание модуля decorators.py:

Этот модуль используется для размещения декоратора log, который автоматически 
логирует начало и конец выполнения функции, а также ее результаты или возникшие ошибки.
Декоратор должен принимать необязательный аргумент filename, который определяет, 
куда будут записываться логи (в файл или в консоль):
- Если filename задан, логи записываются в указанный файл.
- Если filename не задан, логи выводятся в консоль.

Логирование включает:

Имя функции и результат выполнения при успешной операции.
Имя функции, тип возникшей ошибки и входные параметры, если выполнение функции 
привело к ошибке.

## Тестирование модуля decorators.py:

Выполнены тесты:

- Тест успешного выполнения функции, обернутой декоратором log;
- Тест обработки ошибки декоратором, если в функцию передано не число;
- Тест, что декоратор автоматически логирует начало и конец выполнения 
функции.

## Описание модуля operations_reader.py:

В функциях get_data_from_excel() и read_csv_dict_reader() реализовано 
считывание финансовых операций из CSV- и XLSX-файлов.

Функции для считывания финансовых операций из CSV и XLSX принимают путь к 
файлу CSV и XLSX в качестве аргумента.

Обе функции выдают списки словарей с транзакциями.

## Тестирование operations_reader.py:
Функции тестируются использованием patch и mock_open из библиотеки 
unittest.mock.

## Описание модуля operations_category:

Функция number_of_operations_category принимает список с данными о банковских 
операциях и список категорий операций,а возвращает словарь, в котором 
ключи — это названия категорий, а значения — это количество операций в каждой 
категории.

## Описание модуля search_string:

Функция search_string_in_operations принимает список словарей с данными о 
банковских операциях и строку поиска, а возвращает список словарей, у которых 
в описании есть данная строка.

## Использование:

1. Клонируйте репозиторий:

```
git clone https://github.com/Sermin22/HomeworkProject.git
```
2. Перейдите в ветку для разработки <develop>. 
3. Kоды функций прописаны в Python Package "src".
